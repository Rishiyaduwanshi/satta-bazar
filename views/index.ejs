<% const currentMonth = todayDate.toLocaleString('default', { month: 'long' });  %>
<% const year = todayDate.getFullYear(); %> 
<% const month = (todayDate.getMonth() + 1).toString().padStart(2, '0');  %>
<% const day = todayDate.getDate().toString().padStart(2, '0'); %>
<% const monthZeroIndex=todayDate.getMonth(); %>
<% const daysInMonth=new Date(year, month + 1, 0).getDate(); %>
<% const formattedDate = `${year}-${month}-${day}`; %>

<% 
  const oneDayBefore = new Date(todayDate); 
  oneDayBefore.setDate(todayDate.getDate() - 1); 
  const yearOneDayBefore = oneDayBefore.getFullYear();
  const monthOneDayBefore = (oneDayBefore.getMonth() + 1).toString().padStart(2, '0');
  const monthOneDayBeforeString = oneDayBefore.getMonth()
  const dayOneDayBefore = oneDayBefore.getDate().toString().padStart(2, '0');
  const formattedDateOneDayBefore = `${yearOneDayBefore}-${monthOneDayBefore}-${dayOneDayBefore}`;
%>

<% 
  const twoDaysBefore = new Date(todayDate); 
  twoDaysBefore.setDate(todayDate.getDate() - 2); 
  const yearTwoDaysBefore = twoDaysBefore.getFullYear();
  const monthTwoDaysBefore = (twoDaysBefore.getMonth() + 1).toString().padStart(2, '0');
  const monthTwoDaysBeforeString = twoDaysBefore.getMonth()
  const dayTwoDaysBefore = twoDaysBefore.getDate().toString().padStart(2, '0');
  const formattedDateTwoDaysBefore = `${yearTwoDaysBefore}-${monthTwoDaysBefore}-${dayTwoDaysBefore}`;
%>


<%- include('./partials/header', {
    title: `Satta Bazar Starline ${year} Chart And Result of ${currentMonth} ${year} for Gali, Desawar, Ghaziabad and Faridabad`,
    externalCSS: [
        '/stylesheets/index.css'
    ],
    internalCSS: `
        #logo-font {
            font-weight: 900;
            color: black;
            display: block;
        }

        #logo {
            display: block;
        }

        #superfast-result {
            color: red;
            font-size: medium;
        }

        #today {
            color: black;
        }      
    `
}) %>

<body>
    <div id="header"> <!-- Google Tag Manager (noscript) -->
        <!-- End Google Tag Manager (noscript) -->
        <div id="logo">
            <a href="/"> 
                <h1 style="font-size: x-large;" id="logo-font">SATTA-BAZAR-STARLINE.com</h1>
            </a>
        </div>
    </div>
    <div id="section">
        <div id="container">
            <h1 class="ads" style="padding:2px 0; margin:0; font-size: small">
                <marquee behavior="" direction="" id="superfast-result">Superfast Result of all satta <span id="today"><%= todayDate.toDateString() %> </span></marquee>
                Daily Superfast Satta Bazar Result of <%=`${currentMonth} ${year}`%> And Leak Numbers for Gali, Desawar,
                Mumbai Starline, Delhi Bazar,Shree Ganesh ,Ghaziabad and
                Faridabad With
                Complete Old Satta Bazar Starline Chart of 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025 From Satta
                Bazar Mumbai Starline Delhi Bazar, Shree Ganesh, Faridabad Ghaziabad,Gali and Desawar.
            </h1>

            <div class="main-content">
            <!-- *************************************** Interval Slot START ********************* -->
        <table class="quick-result-board">
            <tr class="board-title">
            <th colspan="3">
                <h1>Satta Bazar Starline Results of <%= `${intervalResults[0].date.toDateString()}` %></h1>
            </th>
            </tr>
        <% intervalResults?.forEach(d => { 
            const resultTime = new Date(d.date);
            const nextResultTime = new Date(d.date);
            nextResultTime.setMinutes(nextResultTime.getMinutes() + (d?.intervalSlot?.everyMinutes || 0));
        %>
            <tr class="board-head">
            <th class="games-name"><h2>Game</h2></th>
            <th class="yesterday-date" id="prevTime<%=d.id  %>">
                <h2><%= resultTime.toLocaleString("default", { hour: "2-digit", minute: "2-digit", hour12: true }).toUpperCase() %></h2>
            </th>
            <th class="today-date" id="nxtTime<%=d.id  %>">
                <h2><%= nextResultTime.toLocaleString("default", { hour: "2-digit", minute: "2-digit", hour12: true }).toUpperCase() %>
                </h2>
            </th>
            </tr>
            <tr class='game-result highlight' id='GD'>
            <td class="game-details">
                <h3 class="game-name"><%= d.name %></h3>
                <h3 class="game-time">Next Result in <%= d?.intervalSlot?.everyMinutes || "" %> min</h3>
                <h3 class="game-link">
                <a href="/dailyresult?game=<%= d.name %>&date=<%= formattedDate %>">Record Chart</a>
                </h3>
            </td>
            <td class="yesterday-number" id="prevRes<%=d.id  %>"><h3><%= d.result.toString().padStart(2,0) %></h3></td>
            <td class="today-number" id="nxtRes<%=d.id  %>"><h3>XX</h3></td>
            </tr>
        <% }); %>
        </table>

        <!-- *************************************** Interval Slot END ********************* -->
                <p>
                    ‚¨ÜÔ∏è‚¨ÜÔ∏è‚¨ÜÔ∏è <br>
                    ‡§Ø‡§π ‡§ó‡•á‡§Æ 09:30AM ‡§¨‡§ú‡•á ‡§¶‡§ø‡§® ‡§∏‡•á 10:00PM ‡§§‡§ï ‡§π‡§∞ (30 min) ‡§Ü‡§ß‡•á ‡§ò‡§Ç‡§ü‡•á ‡§Æ‡•á‡§Ç ‡§ñ‡•Å‡§≤‡§§‡•Ä ‡§π‡•à | ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ
                    <br>_______________________ <br>üí∏‡§∞‡•á‡§üüí∏ ‡§ú‡•ã‡§°‡§º‡•Ä 100 ‡§ï‡•á 10,000 ‡§π‡§∞‡§´ 100 ‡§ï‡•á 1000 Rules of game
                    Rate_10_ka_1000 Game Time 09:30AM-10:00PM (‡§π‡§∞ 30minutes¬†‡§Æ‡•á‡§Ç¬†‡§è‡§ï¬†‡§ó‡•á‡§Æ)
                </p>

            </div>

<!-- *******************************Other Games START******************************* -->
<div class="main-content">
    <table class="quick-result-board">
        <tr class="board-title">
            <th colspan="3">
                <h1>Satta Bazar Starline Results of <%= todayDate.toDateString() %> & <%= oneDayBefore.toDateString() %></h1>
            </th>
        </tr>
        <tr class="board-head">
            <th class="games-name">
                <h2>Games List</h2>
            </th>
            <th class="yesterday-date">
                <h2><%= oneDayBefore.toDateString().substring(3,10) %></h2>
            </th>
            <th class="today-date">
                <h2><%= todayDate.toDateString().substring(3,10) %></h2>
            </th>
        </tr>

        <% if (otherGames) { %>
            <% otherGames.forEach(function (gameResult) { %>
                <tr class='game-result'>
                    <td class="game-details">
                        <h3 class="game-name">
                            <%= gameResult._id %>
                        </h3> <!-- Game Name -->
                        <h3 class="game-link">At <%=gameResult.results[0].date.toLocaleTimeString('en-US',{
                            hour: '2-digit',
                            minute: '2-digit',
                            hour12: true
                          }).replace(/^(\d):/, '0$1:') %>&nbsp &nbsp<a href="/monthlyResult?month=<%= month %>&year=<%= year %>">Record Chart</a></h3>
                    </td>
                    <td class="yesterday-number">
                        <% 
                        // Check for yesterday's result
                        const yesterdayResult = gameResult.results.find(result => new Date(result.date).toDateString() === oneDayBefore.toDateString());
                        %>
                        <% if (yesterdayResult) { %>
                            <h3>
                                <%= yesterdayResult.result.toString().padStart(2, '0') %>
                            </h3> <!-- Yesterday's result -->
                        <% } else { %>
                            <h3>XX</h3>
                        <% } %>
                    </td>
                    <td class="today-number">
                        <% 
                        // Check for today's result
                        const todayResult = gameResult.results.find(result => new Date(result.date).toDateString() === todayDate.toDateString());
                        %>
                        <% if (todayResult) { %>
                            <h3>
                                <%= todayResult.result.toString().padStart(2, '0') %>
                            </h3>
                        <% } else { %>
                            <h3>XX</h3>
                        <% } %>
                    </td>
                </tr>
            <% }); %>
        <% } %>

        <tr class="board-head" id="old">
            <th colspan="3">
                <h2><a href="/monthlyresult?month=<%= month %>&year=<%= year %>">Click here for game monthly results.</a></h2>
            </th>
        </tr>
    </table>
</div>


<!-- *******************************Other Games END******************************* -->

            <!-- ***************************Monthly Chart START*********************************** -->
            
            <div id="mix-chart" class="chart">
                <table class="chart-table">
                    <tr class="chart-head">
                        <td colspan="7" class="month">
                            <h1> Monthly Satta-Bazar-Starline Result Chart for <%= todayDate.toLocaleString('default', {
                                    month: 'long' }) %>
                                    <%= todayDate.getFullYear() %>
                            </h1>
                        </td>
                    </tr>
                    <tr class="date-name">
                        <td class="date" title="Days in the current month">DATE</td>
                        <% monthlyResults.forEach(game=> { %>
                            <th class="name">
                                <%= game._id %>
                            </th> <!-- Game name -->
                            <% }) %>
                    </tr>
    
                    <!-- Get the number of days in the current month -->
                                <!-- Last day of the current month -->
                                <!-- Loop through each day of the month -->
                <% for (let day=1; day <=daysInMonth; day++) { %>
                                    <tr class="day-number">
                                        <td class="day"
                                            title="<%= todayDate.toLocaleString('default', { month: 'long' }) %> <%= day < 10 ? '0' + day : day %>, <%= year %>">
                                            <%= day < 10 ? '0' + day : day %>
                                        </td>
    
                                        <% monthlyResults.forEach(game=> {
                                            // Find the result for the current day
                                            let result = game.resultsByDay.find(r => {
                                            const resultDate = new Date(r.date);
                                            return resultDate.getDate() === day && resultDate.getMonth() === monthZeroIndex &&
                                            resultDate.getFullYear() === year;
                                            });
                                        
                                            %>
                                            <td class="number">
                                                <%= result ? result.result.toString().padStart(2,"0") : 'XX' %>
                                            </td>
                                            <% }) %>
                                    </tr>
                                    <% } %>
                </table>
            </div>
    


            <!-- *************************Monthly Chart END*********************************** -->

            <div class="nav-link" title=" Satta Result Chart With Record">
                <a href="/monthlyResult?month=<%=month%>&year=<%=year%>">
                    <h1 class="nav-text"><%= currentMonth+"-"+year%> Ka Gali, Desawar, Ghaziabad Aur Faridabad Ka Latest Chart Dekhne
                        Ke Liye Yahan Click Kariye</h1>
                </a>
            </div>
        </div>


        <div class="ads" style="padding:8px 0; margin:8px 0; background: white">
            <p style="color:blue; font-size: small;">
                Satta-Bazar-Starline.com is most popular gaming discussion forum for players to use freely and we
                are not
                in partnership with any gaming company.
            </p>
        </div>
        <div class="ads" style="padding:8px; margin:8px 0; background: white">
            <p style="color:red; font-size: big; line-height: 1.4em">
                ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç, ‡§≤‡•Ä‡§ï ‡§ó‡•á‡§Æ ‡§ï‡•á ‡§®‡§æ‡§Æ ‡§™‡§∞ ‡§ï‡§ø‡§∏‡•Ä ‡§ï‡•ã ‡§ï‡•ã‡§à ‡§™‡•à‡§∏‡§æ ‡§® ‡§¶‡•á‡§Ç, ‡§®‡§æ ‡§™‡§π‡§≤‡•á ‡§®‡§æ ‡§¨‡§æ‡§¶ ‡§Æ‡•á -‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶
            </p>
        </div>
        <div class="ads" style="padding:8px 0; margin:8px 0; background: white">
            <h2 style="color:green; font-size: big; line-height: 1.5;">
                ‡§π‡§Æ‡§∏‡•á ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‚û°Ô∏è
                <a href="https://forms.gle/sgFNeZpgXqYmF62LA"
                    style="color:blue; font-size: big"> ‡§Ø‡§π‡§æ‡§Å ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç</a>
            </h2>
        </div>


        <div id="footer">
            <div id="chart-form">
                <h2 id="chart-text">Yahan Aap Month Aur Year Select Karke Gali, Desawar, Ghaziabad Aur Faridabad Ka
                    Combined Chart Dekh Sakte Hai.</h2>
                <form action="/monthlyresult" method="get">
                    <select id="month" name="month">
                        <option value="01">January</option>
                        <option value="02">February</option>
                        <option value="03">March</option>
                        <option value="04">April</option>
                        <option value="05">May</option>
                        <option value="06">June</option>
                        <option value="07">July</option>
                        <option value="08">August</option>
                        <option value="09">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                    <select id="year" name="year">
                    </select>
                    <input id="direct-chart" type="submit" value="Go">
                </form>
            </div>
            <a style="position:fixed; bottom:20px;right:8px;">&nbsp;<input
                    style="border:#e7aa26 1px solid; background:#FBC503; color:Red; height:auto; padding:8px; font-weight:bold;"
                    id="Refresh" name="Refresh" value="Refresh" type="submit"
                    onclick="window.location.reload()">&nbsp;</a>
        </div>


        <%-include('./partials/footer') %>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
        <script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
        <script>
            let yearOptions = "";
            for(let i = 2015; i<=parseInt(new Date().getFullYear()); i++){
                yearOptions+= `<option value="${i}">${i}</option>`
            }
            document.getElementById("year").innerHTML = yearOptions;
            document.getElementById("year").value = new Date().getFullYear();
            let currentMonth = String(new Date().getMonth() + 1).padStart(2, '0');
            document.getElementById("month").value = currentMonth;
        </script>

        <script>
            function parseTimeTo24Hr(timeStr) {
                const [time, period] = timeStr.trim().split(" ");
                let [hours, minutes] = time.split(":").map(Number);
                if (period === "PM" && hours !== 12) hours += 12;
                if (period === "AM" && hours === 12) hours = 0;
            return { hours, minutes };
            }

            function isAfter10PM(timeStr) {
                const { hours, minutes } = parseTimeTo24Hr(timeStr);
                return hours > 22 || (hours === 22 && minutes > 0);
            }

            document.addEventListener("DOMContentLoaded", function () {
                const allTimeHeaders = document.querySelectorAll("[id^='nxtTime']");

                allTimeHeaders.forEach(header => {
                    const idNum = header.id.replace("nxtTime", "");
                    const resCell = document.getElementById(`nxtRes${idNum}`);
                    const timeText = header.textContent.trim();

                    if (isAfter10PM(timeText)) {
                        header.remove();
                        resCell?.remove();

                        const prevTime = document.getElementById(`prevTime${idNum}`);
                        const prevRes = document.getElementById(`prevRes${idNum}`);
                        if (prevTime) prevTime.setAttribute("colspan", "2");
                        if (prevRes) prevRes.setAttribute("colspan", "2");
                    }
                });
            });

        </script>
</body>
</html>
