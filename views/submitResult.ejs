<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Result</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="/toastr/toastr.min.css">
    <script src="/toastr/toastr.min.js"></script>
    <!-- Custom Stylesheet -->
    <link rel="stylesheet" href="/stylesheets/submitresult.css">
</head>

<body>
    <!-- Include Navbar -->
    <%- include('./partials/navbar') %>
    <div class="container mt-5 result-container">
        <h2 class="text-center mb-4 mt-1">Submit Result</h2>

        <!-- Display Flash Message -->

        <form id="resultForm" class="mx-auto" style="max-width: 600px;" action="/submitresult" method="POST">
            <!-- Team Input -->
            <div class="mb-3">
                <label for="game" class="form-label">GameList</label>
                <select id="game" name="game" class="form-select" required>
                    <option value="">Select Game</option>
                    <% gameList.forEach(function(game) { %>
                        <option value="<%= game %>"><%= game %></option>
                    <% }); %>
                </select>
            </div>
        
            <!-- Date Input -->
            <div class="mb-3">
                <label for="date" class="form-label">Date</label>
                <input type="date" id="date" name="date" class="form-control" required>
            </div>
        
            <!-- Time Input -->
            <div class="mb-3" id="timeInput">
                <label for="time" class="form-label">Time</label>
                <input type="time" id="time" name="time" class="form-control" required max="22:00" min="10:00">
            </div>
        
            <!-- Result Input -->
            <div class="mb-3">
                <label for="result" class="form-label">Result</label>
                <input type="number" id="result" name="result" class="form-control" placeholder="Enter result" required min="0" max="99">
            </div>
        
            <!-- Submit Button -->
            <div class="text-center">
                <button type="submit" class="btn btn-primary" id="formSubmit">Submit</button>
            </div>
        </form>
    </div>


    <%-include('./partials/footer') %>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- <script src="/scripts/date.js"></script> -->
    <script>
        '<% if (signupSuccess.length > 0) { %>'
            toastr.success("<%= signupSuccess %>");
        '<% } %>'
    
        '<% if (success.length > 0) { %>'
            toastr.success('<%= success %>');
        '<% } %>'
    
        '<% if (error.length > 0) { %>'
            toastr.error('<%= error %>');
        '<% } %>'
    
        const submitBtn = document.getElementById("formSubmit");
        const timeInput = document.getElementById("time");
        const resultForm = document.getElementById("resultForm");
    
        // Function to validate time input
        function validateTime() {
            const timeValue = timeInput.value;
            const hour = parseInt(timeValue.substring(0, 2)); // Extract hour
    
            return hour >= 10 && hour <= 22; // Validation passed if within range
        }
    
        // Event listener for the submit button
        submitBtn.addEventListener("click", function(event) {
            if (!validateTime()) {
                event.preventDefault(); // Prevent form submission
                toastr.error("Time should be between 10:00 AM to 10:00 PM");
            }
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Retrieve previous data from session storage if it exists
            if (sessionStorage.getItem("oldResultData")) {
                const previousData = JSON.parse(sessionStorage.getItem("oldResultData"));
                
                document.getElementById("game").value = previousData.game || "";
                document.getElementById("date").value = previousData.date || "";
                document.getElementById("time").value = previousData.time || "";
                document.getElementById("result").value = previousData.result || "";
            }
        
            const submitBtn = document.getElementById("formSubmit");
        
            submitBtn.addEventListener("click", function(event) {
                // Gather data from the form
                const formData = {
                    game: document.getElementById("game").value,
                    date: document.getElementById("date").value,
                    time: document.getElementById("time").value,
                    result: document.getElementById("result").value
                };
                // Store the form data in session storage
                sessionStorage.setItem("oldResultData", JSON.stringify(formData));
            });
        });
        
    </script>
    
</body>

</html>
